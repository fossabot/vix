override CXXFLAGS += -nostdlib -fno-pie -mno-red-zone -ffreestanding -fno-exceptions -mno-mmx -mno-sse -mno-sse2

ifeq ($(CONFIG_ENABLE_KERNEL_64), y)
override CXXFLAGS += -mcmodel=kernel
endif

%.onasm: %.asm
	@echo "  NASM $<"
	@nasm -f elf $< -o $@

ifeq ($(CONFIG_ENABLE_FTRACE), y)
override CXXFLAGS += -finstrument-functions
endif

ifeq ($(CONFIG_ENABLE_STACKPROTECTOR), y)
override CXXFLAGS += -fstack-protector-strong -mstack-protector-guard=global
else
override CXXFLAGS += -fno-stack-protector
endif
